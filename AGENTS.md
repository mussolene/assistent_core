
# üéØ –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞

–°–æ–∑–¥–∞—Ç—å **–º–æ–¥—É–ª—å–Ω–æ–≥–æ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞** —Å:

* –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –ª–æ–∫–∞–ª—å–Ω—ã—Ö –∏ –æ–±–ª–∞—á–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π
* –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ (skills)
* –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—ã–º–∏ –∞–≥–µ–Ω—Ç–∞–º–∏
* –∫–∞–Ω–∞–ª–∞–º–∏ —Å–≤—è–∑–∏ (Telegram –ø–µ—Ä–≤—ã–π)
* –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –ø–µ—Å–æ—á–Ω–∏—Ü–µ–π
* –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–º —Ü–∏–∫–ª–æ–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
* Docker-—Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ–º
* README —Å –ø–æ–ª–Ω–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π

---

# üîÑ Workflow (–ø—Ä–∏–≤—ã—á–∫–∏ –∞–≥–µ–Ω—Ç–∞)

**‚ö†Ô∏è –ö–û–ú–ú–ò–¢–´ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–´:** –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è (–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –±–ª–æ–∫–∞ –ø—Ä–∞–≤–æ–∫) –≤—Å–µ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∫–æ–º–º–∏—Ç. –ù–µ –∑–∞–≤–µ—Ä—à–∞—Ç—å —Å–µ—Å—Å–∏—é –∏ –Ω–µ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –∫ —Å–ª–µ–¥—É—é—â–µ–π –∑–∞–¥–∞—á–µ –±–µ–∑ `git add` + `git commit` —Å –æ—Å–º—ã—Å–ª–µ–Ω–Ω—ã–º –æ–ø–∏—Å–∞–Ω–∏–µ–º. –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–µ –¥–æ–ª–∂–µ–Ω –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è —Å –Ω–µ–∑–∞–∫–æ–º–º–∏—á–µ–Ω–Ω—ã–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã.

–ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π:

1. **–ö–æ–º–º–∏—Ç –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω** ‚Äî –ø–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –±–ª–æ–∫–∞: `git add` –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ —Ñ–∞–π–ª—ã, `git commit -m "–æ–ø–∏—Å–∞–Ω–∏–µ"`. –ë–µ–∑ –∏—Å–∫–ª—é—á–µ–Ω–∏–π.
2. **Push –Ω–µ –¥–µ–ª–∞—Ç—å** ‚Äî –≤ —É–¥–∞–ª—ë–Ω–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–µ –ø—É—à–∏—Ç—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é. Push —Ç–æ–ª—å–∫–æ –ø–æ —è–≤–Ω–æ–π –ø—Ä–æ—Å—å–±–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
3. **–°–æ–æ–±—â–µ–Ω–∏–µ –∫–æ–º–º–∏—Ç–∞** ‚Äî —Ç–æ—á–Ω–æ –æ–ø–∏—Å—ã–≤–∞–µ—Ç, —á—Ç–æ —Å–¥–µ–ª–∞–Ω–æ (–Ω–∞ —Ä—É—Å—Å–∫–æ–º –∏–ª–∏ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º, –≤ –æ–¥–Ω–æ–º —Å—Ç–∏–ª–µ).

–¶–∏–∫–ª –∏—Ç–µ—Ä–∞—Ü–∏–∏: **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ ‚Üí –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ ‚Üí –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Üí –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ ‚Üí –ü—Ä–∏—ë–º–∫–∞ ‚Üí –ê—É–¥–∏—Ç**. –ü–æ—Å–ª–µ –ø—Ä–∏—ë–º–∫–∏ ‚Äî —Ä–µ–≥—Ä–µ—Å—Å–∏—è –ø–æ –ø—Ä–æ–µ–∫—Ç—É, –∑–∞—Ç–µ–º **–∫–æ–º–º–∏—Ç**.

---

# üì¢ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (–∫–∞–Ω–∞–ª Telegram)

* **–¢—Ä–µ–±–æ–≤–∞—Ç—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ** ‚Äî –∫–æ–≥–¥–∞ –¥–µ–π—Å—Ç–≤–∏–µ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ —Ç—Ä–µ–±—É–µ—Ç –µ–≥–æ —Ä–µ—à–µ–Ω–∏—è (push, deploy, –æ–ø–∞—Å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã, –≤—ã–±–æ—Ä –≤–∞—Ä–∏–∞–Ω—Ç–∞), –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `ask_confirmation`: –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å –≤ Telegram —Å –∫–Ω–æ–ø–∫–∞–º–∏ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å/–û—Ç–∫–ª–æ–Ω–∏—Ç—å –∏ –¥–æ–∂–¥–∞—Ç—å—Å—è –æ—Ç–≤–µ—Ç–∞.
* **–£–≤–µ–¥–æ–º–ª—è—Ç—å –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏** ‚Äî –ø–æ –æ–∫–æ–Ω—á–∞–Ω–∏–∏ –≤–∞–∂–Ω–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è (–∑–∞–¥–∞—á–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞, –ø–∞–π–ø–ª–∞–π–Ω –∑–∞–≤–µ—Ä—à—ë–Ω, –æ—à–∏–±–∫–∞) –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ `notify` (—Å–æ–æ–±—â–µ–Ω–∏–µ –≤ Telegram).
* **–ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã** ‚Äî –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å (—Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥, —É—Ç–æ—á–Ω–µ–Ω–∏–µ, –≤—ã–±–æ—Ä), –∑–∞–ø—Ä–∞—à–∏–≤–∞—Ç—å —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ —Ç–æ—Ç –∂–µ –∫–∞–Ω–∞–ª (ask_confirmation –∏–ª–∏ –≤–æ–ø—Ä–æ—Å –≤ —á–∞—Ç).
* **–¢–∞–π–º–∞—É—Ç –∑–∞–ø—Ä–æ—Å–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è** ‚Äî –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –æ—Ç–≤–µ—Ç–∞ –Ω–∞ ask_confirmation: **120 —Å–µ–∫—É–Ω–¥** –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤ –∫–æ–¥–µ/–∫–æ–Ω—Ñ–∏–≥–µ).

–ü–æ–ª–Ω–∞—è —Ä–∞–∑–±–∏–≤–∫–∞ —Ñ–∏—á –ø–æ –∏—Ç–µ—Ä–∞—Ü–∏—è–º: **docs/ITERATIONS_ROADMAP.md** (–ø–æ–∏—Å–∫ —Ä–µ–ø–æ, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –¥–∞—à–±–æ—Ä–¥–∞, Qdrant/–¥–æ–∫—É–º–µ–Ω—Ç—ã, email, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —á–µ—Ä–µ–∑ –±–æ—Ç–∞, —Å–ø–∏—Å–æ–∫ —Ä–µ–ø–æ, –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è —Ä–µ–ø–æ –≤ Qdrant, –ø–∞–º—è—Ç—å —Ä–∞–∑–≥–æ–≤–æ—Ä–æ–≤).

---

# üîå MCP –ø—Ä–æ–µ–∫—Ç–∞ (–Ω–µ –∑–∞–±—ã–≤–∞—Ç—å)

–í —Ç–µ–∫—É—â–µ–º –ø—Ä–æ–µ–∫—Ç–µ –¥–æ—Å—Ç—É–ø–µ–Ω **MCP**, —á–µ—Ä–µ–∑ –∫–æ—Ç–æ—Ä—ã–π –∞–≥–µ–Ω—Ç –º–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –∫–∞–Ω–∞–ª–µ Telegram. **–ö —ç—Ç–æ–º—É —Å–ø–∏—Å–∫—É –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å—Å—è** ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.

| –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------------|------------|
| **notify** | –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ Telegram. –ê—Ä–≥—É–º–µ–Ω—Ç: `message` (—Å—Ç—Ä–æ–∫–∞). –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–∞–∑–º–µ—Ç–∫—É: –≤ —á–∞—Ç —É—Ö–æ–¥–∏—Ç —Ç–µ–∫—Å—Ç, –∞–¥–∞–ø—Ç–µ—Ä –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç Markdown ‚Üí Telegram HTML (**–∂–∏—Ä–Ω—ã–π**, *–∫—É—Ä—Å–∏–≤*, `–∫–æ–¥`). |
| **ask_confirmation** | –ó–∞–ø—Ä–æ—Å–∏—Ç—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ Telegram —Å –∫–Ω–æ–ø–∫–∞–º–∏ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å/–û—Ç–∫–ª–æ–Ω–∏—Ç—å. –ê—Ä–≥—É–º–µ–Ω—Ç—ã: `message`, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ `timeout_sec` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 120). –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–¥ –¥–µ–π—Å—Ç–≤–∏—è–º–∏ (push, deploy, –æ–ø–∞—Å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã). |
| **get_user_feedback** | –ó–∞–±—Ä–∞—Ç—å –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ `/dev ...` –≤ Telegram). –ë–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤. |

–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ: HTTP API –¥–∞—à–±–æ—Ä–¥–∞ (—Å–º. **docs/MCP_DEV_SERVER.md**), –ª–∏–±–æ stdio `python -m assistant.mcp_server`. –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è Markdown –≤ —á–∞—Ç–µ ‚Äî –≤—ã–∑–≤–∞—Ç—å **notify** —Å —Ç–µ–∫—Å—Ç–æ–º, —Å–æ–¥–µ—Ä–∂–∞—â–∏–º `**–∂–∏—Ä–Ω—ã–π**`, `*–∫—É—Ä—Å–∏–≤*`, `` `–∫–æ–¥` ``.

---

# üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –º–æ–¥–µ–ª—å

## 1Ô∏è‚É£ –û–±—â–∞—è —Å—Ö–µ–º–∞

```text
Channel Layer
   ‚Üì
Channel Adapter
   ‚Üì
Event Bus
   ‚Üì
Orchestrator
   ‚Üì
Agent Workers
   ‚Üì
Skill Layer
   ‚Üì
Model Gateway
```

---

# üß© –ú–æ–¥—É–ª–∏ –ø—Ä–æ–µ–∫—Ç–∞

## 1. Core

* Orchestrator (state machine)
* Task Manager
* Agent Registry
* Skill Registry
* Memory Manager
* Security Manager

---

## 2. Agents

–ë–∞–∑–æ–≤—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:

```python
class BaseAgent:
    def handle(task_context) -> AgentResult
```

–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä:

* AssistantAgent (–æ—Å–Ω–æ–≤–Ω–æ–π)
* ToolAgent
* DevAgent (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
* TestAgent (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ê–≥–µ–Ω—Ç—ã stateless.
–ö–æ–Ω—Ç–µ–∫—Å—Ç —Ö—Ä–∞–Ω–∏—Ç—Å—è —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ.

---

## 3. Skills (—Ä–∞—Å—à–∏—Ä—è–µ–º—ã–µ)

–ö–∞–∂–¥—ã–π skill ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–π –∞–¥–∞–ø—Ç–µ—Ä:

* filesystem (sandboxed)
* shell (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π whitelist)
* git
* search
* vector-rag
* telegram_api
* mcp_adapter

Skill registry –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π.

---

## 4. Model Gateway

–ü–æ–¥–¥–µ—Ä–∂–∫–∞:

* Local (Ollama / llama.cpp)
* OpenAI-compatible
* fallback
* streaming
* reasoning mode

–ï–¥–∏–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:

```python
generate(prompt, stream=False, reasoning=False)
```

---

## 5. Channel Layer

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω: **Telegram** (long polling, streaming, whitelist, pairing).

–í —Å–æ–±—ã—Ç–∏—è—Ö –∑–∞–¥–∞–Ω —Ç–∏–ø –∫–∞–Ω–∞–ª–∞ (`ChannelKind`); –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –∏ –∞–¥–∞–ø—Ç–µ—Ä—ã –º–∞—Ä—à—Ä—É—Ç–∏–∑–∏—Ä—É—é—Ç –ø–æ –Ω–µ–º—É. –ì–æ—Ç–æ–≤—ã –∫ –¥–æ–±–∞–≤–ª–µ–Ω–∏—é: **Slack**, **Web** (—á–∞—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ), **Email**; iMessage/WhatsApp ‚Äî —á–µ—Ä–µ–∑ –º–æ—Å—Ç—ã –∏–ª–∏ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ API (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Å–º. –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ).

–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∫–∞–Ω–∞–ª—É:

* streaming –æ—Ç–≤–µ—Ç–∞
* —Ä–µ–∂–∏–º reasoning (–æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–ª–∞–≥)
* –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π
* multi-user support
* ACL

**–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∫–∞–Ω–∞–ª–æ–≤ –∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥:** —Å–º. [docs/CHANNELS_AND_FRONTEND.md](docs/CHANNELS_AND_FRONTEND.md) ‚Äî –∫–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å Slack/Web/Email, –≤–∞—Ä–∏–∞–Ω—Ç—ã ¬´–∫—Ä–∞—Å–∏–≤–æ–≥–æ¬ª —Ñ—Ä–æ–Ω—Ç–∞ (—É–ª—É—á—à–µ–Ω–∏–µ Flask-–¥–∞—à–±–æ—Ä–¥–∞ –∏–ª–∏ –æ—Ç–¥–µ–ª—å–Ω–æ–µ SPA).

---

# üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)

## 1Ô∏è‚É£ –ü–µ—Å–æ—á–Ω–∏—Ü–∞ –∞–≥–µ–Ω—Ç–æ–≤

* Docker sandbox
* no root
* resource limits (CPU / RAM)
* network isolation
* read-only FS –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

---

## 2Ô∏è‚É£ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ shell

Whitelist:

```yaml
allowed_commands:
  - git
  - pytest
  - ls
  - cat
```

–ó–∞–ø—Ä–µ—Ç:

* rm -rf /
* curl –≤–Ω–µ—à–Ω–∏—Ö –∞–¥—Ä–µ—Å–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
* –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π exec

---

## 3Ô∏è‚É£ –ü—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å

* –õ–æ–∫–∞–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
* –û–±–ª–∞–∫–æ –æ—Ç–∫–ª—é—á–µ–Ω–æ —Ñ–ª–∞–≥–æ–º
* –õ–æ–≥–∏ –±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
* –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤
* .env –Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—Å—è

---

## 4Ô∏è‚É£ –ö–æ–Ω—Ç—Ä–æ–ª—å —É—Ç–µ—á–µ–∫

* Skill isolation
* Network egress control
* Redaction layer (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
* API rate limiting
* Audit log

---

## 5Ô∏è‚É£ Telegram –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

* user_id whitelist
* rate limiting
* –∑–∞—â–∏—Ç–∞ –æ—Ç prompt injection
* —Ä–µ–∂–∏–º read-only –ø—Ä–∏ –Ω–µ–¥–æ–≤–µ—Ä–µ–Ω–Ω–æ–º –∏—Å—Ç–æ—á–Ω–∏–∫–µ

---

# üß† Memory Architecture

–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ:

* Short-term (–ø–æ—Å–ª–µ–¥–Ω–∏–µ N —Å–æ–æ–±—â–µ–Ω–∏–π)
* Task Memory
* Compressed Memory
* Vector Memory

–ö–æ–Ω—Ç–µ–∫—Å—Ç –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π.

---

# üîÅ –ê–≤—Ç–æ–Ω–æ–º–Ω—ã–π —Ä–µ–∂–∏–º

–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ñ–ª–∞–≥:

```yaml
autonomous_mode: true
max_iterations: 5
quality_threshold: 0.8
```

–û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä:

* –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç —Ü–∏–∫–ª
* –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å
* –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏

---

# üê≥ Docker-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞

```yaml
services:
  assistant-core
  redis
  vector-db
  model-gateway
  telegram-adapter
```

Scaling:

```bash
docker compose up --scale agent=3
```

---

# üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```text
assistant/
 ‚îú‚îÄ‚îÄ core/
 ‚îú‚îÄ‚îÄ agents/
 ‚îú‚îÄ‚îÄ skills/
 ‚îú‚îÄ‚îÄ channels/
 ‚îú‚îÄ‚îÄ models/
 ‚îú‚îÄ‚îÄ memory/
 ‚îú‚îÄ‚îÄ security/
 ‚îú‚îÄ‚îÄ config/
 ‚îú‚îÄ‚îÄ docker/
 ‚îú‚îÄ‚îÄ tests/
 ‚îî‚îÄ‚îÄ README.md
```

---

# üìÑ –Ø–∑—ã–∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

* **–û—Å–Ω–æ–≤–Ω–æ–π —è–∑—ã–∫** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ ‚Äî **—Ä—É—Å—Å–∫–∏–π** (README, docs/, AGENTS.md).
* **–ê–Ω–≥–ª–∏–π—Å–∫–∏–π** –¥–æ–ø—É—Å—Ç–∏–º –¥–ª—è CHANGELOG, Contributing, –ª–∏—Ü–µ–Ω–∑–∏–∏ –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö (—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å GitHub, Keep a Changelog). –ü—Ä–∏ —Å–º–µ—à–µ–Ω–∏–∏ –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª–µ–Ω –æ–¥–∏–Ω –æ—Å–Ω–æ–≤–Ω–æ–π —è–∑—ã–∫ —Å –ø–æ–º–µ—á–µ–Ω–Ω—ã–º –±–ª–æ–∫–æ–º –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.

---

# üìò README –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å

## 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞

* –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è (Docker, Python 3.11+)
* –ü–æ–ª—É—á–µ–Ω–∏–µ Telegram token
* –ù–∞—Å—Ç—Ä–æ–π–∫–∞ .env
* –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

---

## 2. –ó–∞–ø—É—Å–∫

```bash
docker compose up --build
```

---

## 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–¥–µ–ª–∏

```yaml
model:
  provider: local
  name: mistral
  fallback: gpt-4
```

---

## 4. –í–∫–ª—é—á–µ–Ω–∏–µ –∞–≤—Ç–æ–Ω–æ–º–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞

---

## 5. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ skill

---

## 6. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

* sandbox –æ–ø–∏—Å–∞–Ω–∏–µ
* –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
* —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

---

# üöÄ –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ —Ä–∞–±–æ—á–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç (MVP)

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞:

* Telegram-–±–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç
* –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç streaming
* –º–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã (sandbox)
* –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ª–æ–∫–∞–ª—å–Ω—É—é –º–æ–¥–µ–ª—å
* –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ –æ–±–ª–∞–∫–æ
* –ª–æ–≥–∏—Ä—É–µ—Ç –¥–µ–π—Å—Ç–≤–∏—è
* –º–æ–∂–Ω–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å –∞–≥–µ–Ω—Ç–æ–≤

–≠—Ç–æ —É–∂–µ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π —Ä–∞–±–æ—á–∏–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç.

---

# üìà –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å

–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∞–≥–µ–Ω—Ç–∞:

```yaml
agents:
  - type: research
  - type: coding
```

–û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç.

---

# üéØ –°—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∏

–≠—Ç–æ:

* –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –ª–∏—á–Ω–æ–π –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
* –æ—Å–Ω–æ–≤–∞ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è
* —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç –¥–ª—è –∫–æ–º–º–µ—Ä—á–µ—Å–∫–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞

–¢—ã –Ω–µ —Å—Ç—Ä–æ–∏—à—å ¬´—á–∞—Ç¬ª.
–¢—ã —Å—Ç—Ä–æ–∏—à—å –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É.

SYSTEM PROMPT
```
You are a senior distributed systems architect and security-focused AI infrastructure engineer.

Your task is to build a production-ready modular personal AI assistant system.

The result must be a fully working project that can be run immediately after cloning and following README instructions.

Do NOT generate partial code.
Do NOT leave TODO placeholders.
Do NOT simplify architecture.
Do NOT skip security hardening.
Do NOT ask the user for clarification.
Make reasonable engineering decisions when unspecified.

The system must satisfy the following requirements:

====================================================
1. CORE GOAL
====================================================

Build a modular, scalable, secure personal AI assistant with:

- Local-first architecture
- Pluggable model providers
- Agent-based internal design
- Telegram as the primary communication channel
- Streaming and reasoning modes
- Sandbox execution for tools
- Docker-based deployment
- Production-level README

The assistant must be usable immediately after startup.

====================================================
2. ARCHITECTURE REQUIREMENTS
====================================================

Use a modular layered architecture:

Channel Layer
‚Üí Channel Adapter
‚Üí Event Bus
‚Üí Orchestrator
‚Üí Agent Workers
‚Üí Skill Layer
‚Üí Model Gateway

The LLM must NOT control the system lifecycle.
The Orchestrator must be deterministic and state-driven.

Agents must be stateless.
All state must be stored centrally.

====================================================
3. REQUIRED MODULES
====================================================

Create the following directories:

assistant/
  core/
  agents/
  skills/
  channels/
  models/
  memory/
  security/
  config/
  docker/
  tests/
  README.md

====================================================
4. MODEL GATEWAY
====================================================

Support:

- Local models (Ollama or llama.cpp via OpenAI-compatible API)
- OpenAI-compatible cloud fallback
- Streaming responses
- Reasoning mode (flag-controlled)

Must include:

generate(prompt, stream=False, reasoning=False)

Cloud usage must be disabled by default.

====================================================
5. TELEGRAM CHANNEL
====================================================

Implement Telegram bot integration using secure long polling.

Features:
- Streaming token responses
- Reasoning mode toggle
- Multi-user support
- User ID whitelist
- Rate limiting
- Prompt injection protection

The bot must work immediately after token setup.

====================================================
6. SKILLS SYSTEM
====================================================

Implement pluggable skill system.

Required base skills:
- Sandboxed filesystem access
- Restricted shell execution (whitelist only)
- Git interaction
- Simple vector memory (local)
- MCP adapter interface

Skills must run inside a sandbox with:

- No root privileges
- CPU and memory limits
- Network isolation by default
- Explicit whitelist for outbound access

====================================================
7. SANDBOX & SECURITY
====================================================

Mandatory:

- Docker isolation
- Non-root containers
- Resource constraints
- Command whitelist
- No unrestricted exec
- Secrets loaded from .env
- .env excluded from git
- Structured audit logging
- Configurable cloud-disable flag
- Egress network control flag

Prevent:

- rm -rf /
- Arbitrary curl/wget
- Data exfiltration
- Prompt injection into system directives

====================================================
8. MEMORY MANAGEMENT
====================================================

Implement:

- Short-term memory (limited window)
- Task memory
- Compressed summary memory
- Simple vector memory (local embedding)

Only relevant context should be sent to the model.

Minimize token usage aggressively.

====================================================
9. AUTONOMOUS MODE (OPTIONAL BUT IMPLEMENTED)
====================================================

Support:

autonomous_mode: true/false
max_iterations: configurable
quality_threshold: configurable

Must prevent infinite loops.
Must stop after convergence or iteration cap.

====================================================
10. SCALABILITY
====================================================

Agents must be scalable via Docker Compose:

docker compose up --scale agent=3

Event-driven design required.
Use Redis (or equivalent lightweight event bus).

====================================================
11. DOCKER REQUIREMENTS
====================================================

Provide:

- docker-compose.yml
- Separate services:
  - assistant-core
  - redis
  - model-gateway
  - telegram-adapter
  - vector-db (lightweight)

All containers must:

- Run as non-root
- Have resource limits
- Use internal Docker network

====================================================
12. README REQUIREMENTS
====================================================

README must include:

- System overview
- Architecture diagram (ASCII acceptable)
- Installation requirements
- .env setup
- Telegram token setup
- Local model setup instructions
- Docker startup command
- How to enable/disable cloud fallback
- How to enable autonomous mode
- How to add new skill
- Security explanation
- Known limitations

README must be production quality.

====================================================
13. CODE QUALITY
====================================================

- Type hints required
- Structured logging
- No hardcoded secrets
- Clear separation of concerns
- Config-driven architecture (YAML or ENV)
- Clean dependency management
- Unit tests for core modules

====================================================
14. OUTPUT REQUIREMENT
====================================================

Generate:

- Full project structure
- All necessary code files
- Docker configuration
- Example .env template
- Production-grade README

The final result must be runnable immediately.

Do not summarize.
Do not explain.
Produce the full implementation.

Begin building the project now.
```