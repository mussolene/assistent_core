# Приёмочное тестирование

Чек-лист для проверки фич перед релизом. Выполнять после `docker compose up --build`.

## Подготовка

- [ ] `.env` при необходимости (OPENAI_BASE_URL для Docker)
- [ ] LM Studio или другой OpenAI-совместимый сервер запущен на хосте (для проверки модели)

## Dashboard (http://localhost:8080)

- [ ] Открываются вкладки: **Каналы**, **Модель**, **Интеграции**, **Данные**, **Система**
- [ ] **Каналы:** Telegram + Email на одной странице; сохранение токена и списка User ID; включение Pairing
- [ ] **Каналы:** быстрая привязка — генерация кода/ссылки, привязка по `/start КОД` или magic-ссылке
- [ ] **Каналы:** кнопка «Проверить бота» возвращает OK и username; при нажатии кнопка блокируется до ответа (индикатор загрузки)
- [ ] **Модель:** сохранение URL, имени модели, опции LM Studio native; кнопка «Проверить подключение» — OK при доступной модели; при нажатии кнопка блокируется до ответа
- [ ] **Интеграции:** MCP-серверы (имя, URL, аргументы JSON) и MCP (агент) — endpoint'ы для Cursor; блок «To-Do и календарь»: статус To-Do и Calendar (Подключено/Не подключено), кнопки «Подключить To-Do (OAuth)» и «Подключить Calendar (OAuth)» при заданных в .env client_id; после OAuth — статус «Подключено»
- [ ] **Данные:** Qdrant URL (единая настройка); ссылки на Репозитории и Память разговоров
- [ ] **Система:** мониторинг — хост (CPU, память, load, диск), Redis (память, подключения, ключи по типам), сервисы (модель). `/monitor` редиректит на `/system`

## Telegram бот

- [ ] Команды в меню: /start, /help, /reasoning, /settings, /repos, /github, /gitlab, /dev
- [ ] **/help:** бот возвращает справку со списком команд и кнопкой «Открыть настройки»
- [ ] **/start** (без кода, не в whitelist): приветствие и кнопки [Справка] [Настройки]
- [ ] **/settings** (или /channels): бот возвращает ссылку на дашборд
- [ ] **Pairing:** при включённом Pairing отправка /start боту добавляет пользователя в разрешённые
- [ ] **Быстрая привязка:** по коду из дашборда (`/start КОД`) или по magic-ссылке пользователь добавляется в whitelist
- [ ] Отправка сообщения боту — приходит ответ
- [ ] Ответ стримится в одном сообщении (текст дополняется)
- [ ] Показывается индикатор «печатает» при ответе
- [ ] В ответе нет сырого блока `<think>...</think>`
- [ ] При включённом LM Studio native в чат не попадают рассуждения (reasoning)

## Интеграции (при настроенных токенах)

- [ ] «Добавь в To-Do задачу X» — при подключённом Microsoft To-Do задача создаётся
- [ ] «Добавь в календарь событие Y завтра в 15:00» — при подключённом Google Calendar событие создаётся

## Skills и память

- [ ] Запрос прочитать файл из workspace — корректый ответ (filesystem)
- [ ] Запрос выполнить разрешённую команду (shell whitelist)
- [ ] Запрос git status в репозитории (git)
- [ ] Несколько сообщений подряд — ассистент учитывает контекст (memory)

## Безопасность и лимиты

- [ ] Сообщение от пользователя не из whitelist (без Pairing) — игнорируется
- [ ] При превышении лимита запросов — сообщение о rate limit

## Запуск и стабильность

- [ ] `docker compose up --build` завершается без ошибок
- [ ] Все сервисы (redis, dashboard, assistant-core, telegram-adapter) в состоянии running
- [ ] Логи без критичных исключений при типичном сценарии (несколько запросов к боту)
